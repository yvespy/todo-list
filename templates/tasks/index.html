{% extends 'base.html' %}
{% block content %}
  <h2>TODO List</h2>
  <a href="{% url 'add_task' %}" class="btn btn-success mb-3">+ Add task</a>
  <div class="list-group">
    {% for task in tasks %}
      <div
          class="list-group-item d-flex justify-content-between align-items-start {% if task.is_done %}text-muted{% endif %}">
        <div>
          <h5 class="mb-1">{{ task.content }}</h5>

          <div class="mb-2">
        <span class="badge {% if task.is_done %}bg-success{% else %}bg-warning text-dark{% endif %}">
            {% if task.is_done %}Done{% else %}Not Done{% endif %}
        </span>
          </div>

          <small class="d-block">Created at: {{ task.created_at|date:"Y-m-d H:i" }}</small>

          {% if task.deadline %}
            <small class="d-block">Deadline: {{ task.deadline|date:"Y-m-d H:i" }}</small>
          {% endif %}

          {% if task.tags.all %}
            <small class="d-block">Tags:
              {% for tag in task.tags.all %}
                <span class="badge bg-secondary">{{ tag.name }}</span>
              {% endfor %}
            </small>
          {% endif %}
        </div>
        <div class="d-flex gap-2">
          <a href="{% url 'edit_task' task.pk %}" class="btn btn-sm btn-primary">Edit</a>
          <a href="{% url 'delete_task' task.pk %}" class="btn btn-sm btn-danger">Delete</a>
          <form method="post" action="{% url 'toggle_task' task.pk %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm {% if task.is_done %}btn-warning{% else %}btn-success{% endif %}">
              {% if task.is_done %}Undo{% else %}Complete{% endif %}
            </button>
          </form>
        </div>
      </div>
    {% empty %}
      <p>There is no tasks. Yet ðŸ™ƒ</p>
    {% endfor %}
  </div>
{% endblock %}
